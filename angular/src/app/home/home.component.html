<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModal" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirm Delete</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this post</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="deletePost()">Delete</button>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-9">
    <h2 class="page-header text-center">Post Feed</h2>

    <div class="container show-hide-message">
      <div [ngClass]="messageClass">
        {{ message }}
      </div>
    </div>

    <h3 *ngIf="loading && posts.length==0" class="text-center">Loading...</h3>

    <article class="conatiner post bg-color-light" *ngFor="let post of posts">
      <header class="post-header">
          <h2 class="post-title"><a class="post-title-link" [routerLink]="['/post/', post._id]">{{post.title}}</a></h2>
        <span class="post-meta"><small>by <strong><a [routerLink]="['/user/', post.createdBy.username]">{{post.createdBy.first_name}} {{post.createdBy.last_name}}</a></strong> on {{ post.createdAt | date:'MMM dd, yyyy' }}</small></span>
      </header>
      <div class="post-body">
        <p>{{post.body}}</p>
      </div>
      <footer class="post-footer">
        <div *ngIf="authService.loggedIn() && user && user._id!=post.createdBy._id">
          <button type="button" class="btn btn-sm" [ngClass]="{'btn-info': !post.likedByUser, 'btn-primary': post.likedByUser}" (click)="likePost(post._id)">Like{{post.likedByUser?'d':''}}: {{post.likes}}</button>
          <button type="button" class="btn btn-sm" [ngClass]="{'btn-info': !post.dislikedByUser, 'btn-primary': post.dislikedByUser}" (click)="dislikePost(post._id)">Dislike: {{post.dislikes}}</button>
          <button type="button" class="btn btn-sm btn-warning" [routerLink]="['/post/', post._id]">Comments: {{post.comments}}</button>
        </div>
        <div *ngIf="authService.loggedIn() && user && user.username==post.createdBy.username">
          <button type="button" class="btn btn-sm btn-success" [routerLink]="['/edit/', post._id]">Edit</button>
          <button type="button" class="btn btn-sm btn-danger" (click)="prepareToDelete(post._id)" data-toggle="modal" data-target="#deleteModal">Delete</button>
          <small><strong>Likes:</strong> {{post.likes}} <strong>Dislikes:</strong> {{post.dislikes}}</small>
        </div>
        <div *ngIf="!user || !authService.loggedIn()">
          <small><strong>Likes:</strong> {{post.likes}} <strong>Dislikes:</strong> {{post.dislikes}}</small>
        </div>


        <!-- <div class="dropdown">
          <button type="button" name="button" class="btn btn-success dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Likes: {{ blog.likes }}</button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" href="#">{{ liker }}</a>
          </div>
        </div> -->
      </footer>
    </article>

    <app-pager [totalItems]="2" [itemsPerPage]="postService.postsPerPage" [currentPage]="page" [pagesToShow]="uiService.pagesToShow" [loading]="false"
    (goNext)="onNextPage()" (goPrev)="onPrevPage()" (goPage)="goToPage($event)"></app-pager>
  </div>

  <div class="col-md-3">
    <div *ngIf="popularPosts" class="container post bg-color-light">
      <div class="post-header text-center p-1">
        <h3>Popular</h3>
      </div>
      <div class="post-body p-0">
        <ul class="popular my-0">
          <li *ngFor="let popularPost of popularPosts" class="popular-item">
            <a class="popular-link" [routerLink]="['/post/', popularPost._id]">
              <h5 class=my-0>{{popularPost.title}}</h5>
              <small>by <strong>{{popularPost.createdBy.username}} </strong></small>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

</div>